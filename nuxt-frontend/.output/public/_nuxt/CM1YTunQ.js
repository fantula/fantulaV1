import{dM as u}from"./o2XBa361.js";const q={async getOrders(s){const t=u(),{page:r=1,pageSize:a=20,order_type:d,status:l,exclude_status:n,keyword:f}=s;let e=t.from("orders").select(`
                *,
                profiles(id, uid, avatar, nickname)
            `,{count:"exact"}).order("created_at",{ascending:!1}).range((r-1)*a,r*a-1);d&&(e=e.eq("order_type",d)),l&&(e=e.eq("status",l)),n&&n.length>0&&n.forEach(o=>{e=e.neq("status",o)}),f&&(e=e.ilike("order_no",`%${f}%`));const{data:p,error:c,count:m}=await e;return c?(console.error("获取订单列表失败:",c),{success:!1,orders:[],total:0,error:c.message}):{success:!0,orders:(p||[]).map(o=>{const i=o.profiles||o.profile,g=Array.isArray(i)?i[0]:i||null;return{...o,_profile:g}}),total:m||0}},async updateOrderStatus(s,t){const r=u(),{error:a}=await r.from("orders").update({status:t}).eq("id",s);return a?{success:!1,error:a.message}:{success:!0}},async deleteOrders(s){const t=u(),{error:r}=await t.from("orders").delete().in("id",s);return r?{success:!1,error:r.message}:{success:!0}}};export{q as a};
