import{E as Y}from"./-Yx_0iEM.js";import{E as Z}from"./DC3lfPj1.js";import{a as ee,E as te}from"./Ci1VNkC9.js";import{E as le}from"./BTJpnMK3.js";import{E as oe}from"./C8ZH7i_a.js";import{E as ae}from"./CFoaU_UR.js";import{f as se,r,am as ie,h as re,c as _,b as t,i as T,w as a,G as D,o as d,a as n,l as V,p as z,d as m,a_ as ne,t as M,E as de,ew as me,F as ue,k as pe,n as ce,B as u,_ as fe}from"./o2XBa361.js";import{E as _e,a as ve}from"./0BTaD5f-.js";import{E as ge}from"./1SfIsks3.js";import{E as ke}from"./Cq9RPQ5L.js";import{E as be}from"./CziALilw.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{d as b,b as ye}from"./XmVVhx5S.js";import{A as Ee}from"./DHlfceZi.js";import{v as we}from"./BwD4Hz0h.js";import{E as Ve}from"./BfOrkIVm.js";import"./Culj45X8.js";import"./Dnj8X3EN.js";import"./ClnTspdU.js";import"./Cq9Fpw4b.js";import"./CqX7ZdKI.js";import"./Dlk0BVst.js";import"./qVmxJdp3.js";import"./DtTI1xRr.js";import"./Bh6H2ams.js";import"./t2w4jifC.js";import"./C9zJf5rn.js";import"./Bx0EXMjc.js";import"./Z6faUBN3.js";import"./BlW_46uR.js";import"./hXKBSGVD.js";import"./B_FoF6yT.js";import"./BCItYl8Z.js";import"./BB_Ol6Sd.js";import"./Dzr5IOAO.js";import"./CleHDoLI.js";import"./Ds34GQx2.js";import"./DVQwC1Y0.js";import"./DwwA_QlG.js";import"./BHSqheQV.js";import"./FKUjHIpz.js";import"./CQuNCUIC.js";import"./D6FW0B1r.js";import"./DytS51kl.js";/* empty css        */const Ce={class:"banner-page"},xe={class:"action-bar"},Ie={key:1,class:"text-gray-400"},Be={key:1,class:"placeholder"},he={class:"dialog-footer"},Ue={class:"selector-header"},De={class:"selector-grid"},Se=["onClick"],Fe={class:"selector-name"},$e={class:"dialog-footer"},Ae=se({__name:"banners",setup(Le){const C=r(!1),S=r([]),v=async()=>{C.value=!0;const s=await b.getBanners();s.success&&(S.value=s.banners),C.value=!1},p=r(!1),y=r(!1),o=ie({id:"",image_id:"",title:"",link:"",sort_order:0}),g=r(null),q=()=>{y.value=!1,o.id="",o.image_id="",o.title="",o.link="",o.sort_order=0,g.value=null,p.value=!0},G=s=>{y.value=!0,o.id=s.id,o.image_id=s.image_id,o.title=s.title||"",o.link=s.link||"",o.sort_order=s.sort_order,g.value=s.image||null,p.value=!0},K=async()=>{if(!o.image_id){u.warning("请选择图片");return}if(y.value){const s={title:o.title,link:o.link,sort_order:o.sort_order,image_id:o.image_id},e=await b.updateBanner(o.id,s);e.success?(u.success("更新成功"),p.value=!1,v()):u.error("更新失败: "+e.error)}else{const s=await b.createBanner({image_id:o.image_id,title:o.title,link:o.link,sort_order:o.sort_order});s.success?(u.success("创建成功"),p.value=!1,v()):u.error("创建失败: "+s.error)}},P=async(s,e)=>{const i=e?"on":"off";(await b.updateBanner(s.id,{status:i})).success?u.success("状态已更新"):(u.error("更新失败"),s.status=e?"off":"on")},j=s=>{Ve.confirm("确认删除该轮播图吗？","删除提示",{type:"warning"}).then(async()=>{(await b.deleteBanner(s.id)).success?(u.success("删除成功"),v()):u.error("删除失败")})},k=r(!1),x=r(!1),I=r(""),B=r([]),E=r(""),H=()=>{k.value=!0,F()},F=async()=>{x.value=!0;const s=await ye.getImages({keyword:I.value});s.success&&(B.value=s.images),x.value=!1},J=()=>{const s=B.value.find(e=>e.id===E.value);s&&(g.value=s,o.image_id=s.id,k.value=!1)};return re(()=>{v()}),(s,e)=>{const i=Y,$=Z,c=te,h=le,O=oe,Q=ee,R=ae,A=de,w=ve,U=ge,W=ke,X=_e,L=be,N=we;return d(),_("div",Ce,[t(Ee,null,{default:a(()=>[n("div",xe,[t(i,{type:"primary",icon:V(z),onClick:q},{default:a(()=>[...e[8]||(e[8]=[m("添加轮播图",-1)])]),_:1},8,["icon"]),t(i,{onClick:v,icon:V(ne)},{default:a(()=>[...e[9]||(e[9]=[m("刷新",-1)])]),_:1},8,["icon"])]),e[10]||(e[10]=n("div",{class:"mt-2 text-gray-500 text-sm"}," 提示：轮播图图片需从图片管理中选择，前端展示顺序由排序值决定（越小越靠前）。 ",-1))]),_:1}),T((d(),D(R,{shadow:"never",class:"list-card"},{default:a(()=>[t(Q,{data:S.value,style:{width:"100%"},"row-key":"id"},{default:a(()=>[t(c,{label:"排序",width:"100"},{default:a(({row:l})=>[t($,{type:"info"},{default:a(()=>[m(M(l.sort_order),1)]),_:2},1024)]),_:1}),t(c,{label:"封面图",width:"200"},{default:a(({row:l})=>[l.image?(d(),D(h,{key:0,src:l.image.url,fit:"cover",style:{width:"160px",height:"60px","border-radius":"4px"},"preview-src-list":[l.image.url],"preview-teleported":""},null,8,["src","preview-src-list"])):(d(),_("span",Ie,"无图片"))]),_:1}),t(c,{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""}),t(c,{prop:"link",label:"跳转链接","min-width":"200","show-overflow-tooltip":""}),t(c,{label:"状态",width:"100"},{default:a(({row:l})=>[t(O,{modelValue:l.status,"onUpdate:modelValue":f=>l.status=f,"active-value":"on","inactive-value":"off",onChange:f=>P(l,f==="on")},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(c,{label:"操作",width:"150",align:"right"},{default:a(({row:l})=>[t(i,{link:"",type:"primary",onClick:f=>G(l)},{default:a(()=>[...e[11]||(e[11]=[m("编辑",-1)])]),_:1},8,["onClick"]),t(i,{link:"",type:"danger",onClick:f=>j(l)},{default:a(()=>[...e[12]||(e[12]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})),[[N,C.value]]),t(L,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l),title:y.value?"编辑轮播图":"添加轮播图",width:"500px","append-to-body":"","z-index":2e3},{footer:a(()=>[n("span",he,[t(i,{onClick:e[3]||(e[3]=l=>p.value=!1)},{default:a(()=>[...e[15]||(e[15]=[m("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:K},{default:a(()=>[...e[16]||(e[16]=[m("保存",-1)])]),_:1})])]),default:a(()=>[t(X,{model:o,"label-width":"80px"},{default:a(()=>[t(w,{label:"封面图片",required:""},{default:a(()=>[n("div",{class:"image-selector",onClick:H},[g.value?(d(),D(h,{key:0,src:g.value.url,fit:"cover",class:"preview-img"},null,8,["src"])):(d(),_("div",Be,[t(A,null,{default:a(()=>[t(V(z))]),_:1}),e[13]||(e[13]=n("span",null,"点击选择图片",-1))]))])]),_:1}),t(w,{label:"标题"},{default:a(()=>[t(U,{modelValue:o.title,"onUpdate:modelValue":e[0]||(e[0]=l=>o.title=l),placeholder:"可选"},null,8,["modelValue"])]),_:1}),t(w,{label:"跳转链接"},{default:a(()=>[t(U,{modelValue:o.link,"onUpdate:modelValue":e[1]||(e[1]=l=>o.link=l),placeholder:"可选，例如 /activity/1"},null,8,["modelValue"])]),_:1}),t(w,{label:"排序值"},{default:a(()=>[t(W,{modelValue:o.sort_order,"onUpdate:modelValue":e[2]||(e[2]=l=>o.sort_order=l),min:0},null,8,["modelValue"]),e[14]||(e[14]=n("div",{class:"tips"},"值越小越靠前",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(L,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=l=>k.value=l),title:"选择图片",width:"800px","append-to-body":"","z-index":2100},{footer:a(()=>[n("span",$e,[t(i,{onClick:e[6]||(e[6]=l=>k.value=!1)},{default:a(()=>[...e[17]||(e[17]=[m("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:J,disabled:!E.value},{default:a(()=>[...e[18]||(e[18]=[m("确定",-1)])]),_:1},8,["disabled"])])]),default:a(()=>[n("div",Ue,[t(U,{modelValue:I.value,"onUpdate:modelValue":e[5]||(e[5]=l=>I.value=l),placeholder:"搜索图片",style:{width:"200px"},onInput:F},{prefix:a(()=>[t(A,null,{default:a(()=>[t(V(me))]),_:1})]),_:1},8,["modelValue"])]),T((d(),_("div",De,[(d(!0),_(ue,null,pe(B.value,l=>(d(),_("div",{key:l.id,class:ce(["selector-item",{active:E.value===l.id}]),onClick:f=>E.value=l.id},[t(h,{src:l.url,fit:"cover",class:"selector-img"},null,8,["src"]),n("div",Fe,M(l.name),1)],10,Se))),128))])),[[N,x.value]]),e[19]||(e[19]=n("div",{class:"selector-pagination"},null,-1))]),_:1},8,["modelValue"])])}}}),Kt=fe(Ae,[["__scopeId","data-v-fdec4af0"]]);export{Kt as default};
