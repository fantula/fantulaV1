import{E as N,a as F}from"./Dej0q2Sz.js";import{E as I}from"./CswOF4xx.js";import{E as R}from"./Dj2lpOJg.js";import{E as G}from"./CxsxdZaY.js";import{E as $}from"./BxcDqkou.js";import{r as y,h as H,B as c,f as O,c as C,b as o,w as t,l,o as p,a_ as j,d as s,b2 as q,a as u,cC as J,G as w,D as V,t as d,F as Q,k as W,_ as X}from"./gYbOYKrZ.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{A as Y}from"./Ng33ccKC.js";import{A as Z}from"./CuEj_ZtV.js";import{P as ee}from"./BYrpNS1P.js";/* empty css        *//* empty css        *//* empty css        */import{a as z}from"./BE6q-h-y.js";import{u as te}from"./Ce6k4emn.js";import{E as P}from"./DK0lTgRd.js";import"./BB_Ol6Sd.js";import"./D4AXxtJy.js";import"./Dnj8X3EN.js";import"./BdJc3h2o.js";import"./C3yI_83l.js";import"./Cq9Fpw4b.js";import"./-tO7MSA0.js";import"./pxhmPWjv.js";import"./BSx1rCp4.js";import"./CaswxL1d.js";import"./BlcygIWm.js";import"./Bh6H2ams.js";import"./CUkNyi1D.js";import"./CrRq4wwb.js";import"./C5EOtA6j.js";import"./BPYHQo7_.js";import"./Cr8dt13I.js";import"./DtgOm6Sf.js";import"./BYT9QUPE.js";import"./Djfz0t-N.js";import"./DxwfhIR6.js";import"./BNtqh2Az.js";import"./CzVV9LeR.js";/* empty css        */import"./BO6-pa8Z.js";import"./Cq19oc2c.js";import"./CdHOYNgq.js";import"./B-n2-D39.js";import"./DrogL690.js";import"./YvAJPawC.js";import"./CqTJWtX6.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./CUySdIcD.js";import"./BPU0QgcX.js";/* empty css        */import"./DEN0lkI5.js";import"./gVImYNNu.js";function oe(){const g=y(!1),k=y([]),h=y("unlinked"),n=y([]),r=async()=>{g.value=!0,n.value=[];try{const a=await z.getAllSkus({showUnlinkedOnly:h.value==="unlinked"});a.success?k.value=a.skus||[]:c.error(a.error||"加载失败")}catch(a){c.error(a.message||"系统错误")}finally{g.value=!1}},b=()=>{r()},v=a=>{P.confirm("确认删除此 SKU (包含解除相关联的所有 CDK/商品绑定)？","删除确认",{type:"warning",confirmButtonText:"确定删除",cancelButtonText:"取消"}).then(async()=>{const f=await z.deleteSkus([a.id]);f.success?(c.success("删除成功"),r()):c.error(f.error)})},S=()=>{n.value.length&&P.confirm(`确认批量删除 ${n.value.length} 个 SKU (强制解绑所有关联)？`,"高风险操作",{type:"error",confirmButtonText:"确定删除",cancelButtonText:"取消"}).then(async()=>{const a=await z.deleteSkus(n.value);a.success?(c.success("批量删除成功"),r()):c.error(a.error)})},T=a=>{n.value=a.map(f=>f.id)},x=a=>a?new Date(a).toLocaleString("zh-CN",{fontSize:"12px"}):"-",{getProductTypeLabel:B,getProductTypeTag:E}=te();return H(()=>{r()}),{loading:g,skus:k,filterMode:h,selectedIds:n,loadSkus:r,handleFilterChange:b,handleDelete:v,handleBulkDelete:S,handleSelectionChange:T,formatDate:x,getProductTypeLabel:B,getProductTypeTag:E}}const ae={class:"skus-page"},ie={class:"filter-group"},le={class:"sku-cell"},ne={class:"sku-info"},se={class:"sku-specs"},re={key:0,class:"linked-products"},me={key:1},pe={class:"time-text"},de=O({__name:"skus",setup(g){const{loading:k,skus:h,filterMode:n,selectedIds:r,loadSkus:b,handleFilterChange:v,handleDelete:S,handleBulkDelete:T,handleSelectionChange:x,formatDate:B,getProductTypeLabel:E,getProductTypeTag:a}=oe();return(f,i)=>{const A=F,L=N,D=I,m=R,M=G,_=$;return p(),C("div",ae,[o(ee,{title:"此处显示所有 SKU 物理数据。删除 SKU 将自动解除它与所有商品和CDK的关联，请谨慎操作。",type:"warning"}),o(Y,null,{default:t(()=>[u("div",ie,[o(L,{modelValue:l(n),"onUpdate:modelValue":i[0]||(i[0]=e=>J(n)?n.value=e:null),onChange:l(v)},{default:t(()=>[o(A,{label:"all"},{default:t(()=>[...i[1]||(i[1]=[s("全部",-1)])]),_:1}),o(A,{label:"unlinked"},{default:t(()=>[...i[2]||(i[2]=[s("未连接",-1)])]),_:1})]),_:1},8,["modelValue","onChange"])])]),actions:t(()=>[o(D,{onClick:l(b),icon:l(j)},{default:t(()=>[...i[3]||(i[3]=[s("刷新",-1)])]),_:1},8,["onClick","icon"]),o(D,{type:"danger",icon:l(q),disabled:!l(r).length,onClick:l(T)},{default:t(()=>[...i[4]||(i[4]=[s(" 批量删除 ",-1)])]),_:1},8,["icon","disabled","onClick"])]),_:1}),o(Z,{ref:"adminTableRef",data:l(h),loading:l(k),onSelectionChange:l(x)},{default:t(()=>[o(m,{type:"selection",width:"55"}),o(m,{label:"SKU 规格",width:"280"},{default:t(({row:e})=>[u("div",le,[e.image?(p(),w(M,{key:0,src:e.image,class:"sku-thumb","preview-src-list":[e.image],"preview-teleported":""},null,8,["src","preview-src-list"])):V("",!0),u("div",ne,[u("div",se,[e.tag_name?(p(),w(_,{key:0,size:"small",type:"info",effect:"plain",style:{"margin-right":"4px"}},{default:t(()=>[s(d(e.tag_name),1)]),_:2},1024)):V("",!0),(p(!0),C(Q,null,W(e.spec_combination||{},(K,U)=>(p(),w(_,{key:U,size:"small",effect:"plain",style:{"margin-right":"4px"}},{default:t(()=>[s(d(U)+": "+d(K),1)]),_:2},1024))),128))])])])]),_:1}),o(m,{label:"类型",width:"100",align:"center"},{default:t(({row:e})=>[o(_,{type:l(a)(e.product_type)},{default:t(()=>[s(d(l(E)(e.product_type)),1)]),_:2},1032,["type"])]),_:1}),o(m,{label:"绑定商品","min-width":"200"},{default:t(({row:e})=>[e.is_linked?(p(),C("div",re,[o(_,{type:"success",effect:"plain",size:"small"},{default:t(()=>[s("已绑定 "+d(e.linked_count)+" 个商品",1)]),_:2},1024)])):(p(),C("div",me,[o(_,{type:"danger",effect:"plain",size:"small"},{default:t(()=>[...i[5]||(i[5]=[s("未绑定",-1)])]),_:1})]))]),_:1}),o(m,{label:"库存",width:"100",align:"center"},{default:t(({row:e})=>[u("span",null,d(e.stock_count!==void 0?e.stock_count:"-"),1)]),_:1}),o(m,{label:"创建时间",width:"180",align:"center"},{default:t(({row:e})=>[u("span",pe,d(l(B)(e.created_at)),1)]),_:1}),o(m,{label:"操作",width:"100",align:"center",fixed:"right"},{default:t(({row:e})=>[o(D,{type:"danger",link:"",size:"small",onClick:K=>l(S)(e)},{default:t(()=>[...i[6]||(i[6]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","loading","onSelectionChange"])])}}}),vt=X(de,[["__scopeId","data-v-8c90ec3c"]]);export{vt as default};
