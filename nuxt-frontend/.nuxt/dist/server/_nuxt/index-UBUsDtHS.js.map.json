{"file":"index-UBUsDtHS.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_unref","Plus","Refresh","_createTextVNode","_ssrRenderList","_ssrInterpolate","_ssrRenderComponent","_withCtx","_toDisplayString","_openBlock","_createBlock","_Fragment","_renderList","_createVNode"],"sources":["../../../../pages/_mgmt_9Xfa3/users/departments/index.vue"],"sourcesContent":["<template>\n  <div class=\"page-container\">\n    <PageTipHeader \n      title=\"部门管理\" \n      description=\"创建和管理后台部门，配置可访问的页面权限\"\n    />\n\n    <AdminActionCard>\n      <template #actions>\n        <el-button :icon=\"Refresh\" @click=\"loadDepartments\">刷新</el-button>\n        <el-button type=\"primary\" :icon=\"Plus\" @click=\"openAddDept\">新增部门</el-button>\n      </template>\n    </AdminActionCard>\n\n    <!-- 部门管理布局 -->\n    <el-card shadow=\"never\" class=\"dept-manager-card\">\n      <div class=\"dept-manager\">\n        <div class=\"dept-list-pane\">\n          <div class=\"pane-header\">\n            <span>部门列表</span>\n          </div>\n          <div class=\"dept-list\">\n            <div \n              v-for=\"dept in departments\" \n              :key=\"dept.id\" \n              class=\"dept-item\"\n              :class=\"{ active: currentEditDeptId === dept.id }\"\n              @click=\"selectDeptToEdit(dept)\"\n            >\n              <span class=\"dept-name\">{{ dept.name }}</span>\n              <el-tag size=\"small\" effect=\"plain\">{{ dept.user_count || 0 }} 人</el-tag>\n            </div>\n            <div v-if=\"departments.length === 0\" class=\"empty-list\">\n              <el-empty description=\"暂无部门\" :image-size=\"60\" />\n            </div>\n          </div>\n        </div>\n        <div class=\"dept-config-pane\">\n          <div v-if=\"currentEditDeptObj\" class=\"config-form\">\n            <el-form label-position=\"top\" :model=\"currentEditDeptObj\" ref=\"deptFormRef\">\n              <el-form-item label=\"部门名称\" prop=\"name\" :rules=\"[{ required: true, message: '请输入部门名称', trigger: 'blur' }]\">\n                <el-input v-model=\"currentEditDeptObj.name\" />\n              </el-form-item>\n              <el-form-item label=\"权限配置 (勾选允许访问的后台页面)\">\n                <el-checkbox-group v-model=\"currentEditDeptObj.permissions\" class=\"perm-list\">\n                  <el-checkbox v-for=\"menu in menuList\" :key=\"menu.path\" :value=\"menu.path\">\n                    {{ menu.title }}\n                  </el-checkbox>\n                </el-checkbox-group>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" @click=\"saveDeptConfig\" :loading=\"deptSaving\">保存配置</el-button>\n                <el-button \n                  type=\"danger\" \n                  plain \n                  @click=\"handleDeleteDept\"\n                  :disabled=\"(currentEditDeptObj.user_count || 0) > 0\"\n                >\n                  删除部门\n                </el-button>\n              </el-form-item>\n            </el-form>\n          </div>\n          <div v-else class=\"empty-selection\">\n            <el-empty description=\"请选择左侧部门进行配置\" :image-size=\"80\" />\n          </div>\n        </div>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\nimport { Plus, Refresh } from '@element-plus/icons-vue'\nimport { ElMessage, type FormInstance } from 'element-plus'\nimport { adminDepartmentApi, type AdminDepartment } from '@/api/admin'\n\ndefineOptions({\n  name: 'UserDepartments'\n})\n\ndefinePageMeta({\n  title: '部门管理'\n})\n\n// 使用统一菜单配置 - 权限菜单列表\nimport { getPermissionMenuItems } from '@/config/admin-menu'\nconst menuList = getPermissionMenuItems()\n\n// --- State ---\nconst departments = ref<AdminDepartment[]>([])\nconst currentEditDeptId = ref('')\nconst currentEditDeptObj = ref<AdminDepartment | null>(null)\nconst deptFormRef = ref<FormInstance>()\nconst deptSaving = ref(false)\n\n// --- Load Data ---\nconst loadDepartments = async () => {\n  try {\n    const result = await adminDepartmentApi.getDepartments()\n    if (result.success) {\n      departments.value = result.departments\n    }\n  } catch (e: any) {\n    ElMessage.error(e.message || '加载部门失败')\n  }\n}\n\n// --- Department Logic ---\nconst selectDeptToEdit = (dept: AdminDepartment) => {\n  currentEditDeptId.value = dept.id\n  currentEditDeptObj.value = JSON.parse(JSON.stringify(dept))\n}\n\nconst openAddDept = async () => {\n  const result = await adminDepartmentApi.createDepartment({ name: '新部门', permissions: [] })\n  if (result.success && result.department) {\n    await loadDepartments()\n    selectDeptToEdit(result.department)\n    ElMessage.success('部门已创建')\n  } else {\n    ElMessage.error(result.error || '创建失败')\n  }\n}\n\nconst handleDeleteDept = async () => {\n  if (!currentEditDeptObj.value) return\n  const result = await adminDepartmentApi.deleteDepartment(currentEditDeptObj.value.id)\n  if (result.success) {\n    ElMessage.success('部门已删除')\n    currentEditDeptId.value = ''\n    currentEditDeptObj.value = null\n    await loadDepartments()\n  } else {\n    ElMessage.error(result.error || '删除失败')\n  }\n}\n\nconst saveDeptConfig = async () => {\n  if (!currentEditDeptObj.value) return\n  deptSaving.value = true\n  try {\n    const result = await adminDepartmentApi.updateDepartment(currentEditDeptObj.value.id, {\n      name: currentEditDeptObj.value.name,\n      permissions: currentEditDeptObj.value.permissions,\n    })\n    if (result.success) {\n      ElMessage.success('部门配置已保存')\n      await loadDepartments()\n    } else {\n      ElMessage.error(result.error || '保存失败')\n    }\n  } finally {\n    deptSaving.value = false\n  }\n}\n\n// --- Init ---\nonMounted(async () => {\n  await loadDepartments()\n})\n</script>\n\n<style scoped>\n.dept-manager-card {\n  margin-top: 16px;\n}\n\n/* Department Manager Layout */\n.dept-manager {\n  display: flex;\n  height: 500px;\n  border: 1px solid var(--el-border-color);\n  border-radius: 4px;\n}\n\n.dept-list-pane {\n  width: 280px;\n  border-right: 1px solid var(--el-border-color);\n  display: flex;\n  flex-direction: column;\n}\n\n.pane-header {\n  padding: 12px 16px;\n  background: var(--el-fill-color-light);\n  border-bottom: 1px solid var(--el-border-color);\n  font-weight: 600;\n  color: var(--admin-text-regular);\n}\n\n.dept-list {\n  flex: 1;\n  overflow-y: auto;\n}\n\n.dept-item {\n  padding: 14px 16px;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  transition: all 0.2s;\n  border-bottom: 1px solid var(--el-border-color-lighter);\n}\n\n.dept-item:hover { \n  background: var(--el-fill-color-light); \n}\n\n.dept-item.active { \n  background: var(--el-color-primary-light-9); \n  color: var(--el-color-primary); \n  font-weight: 600; \n}\n\n.dept-name { \n  flex: 1; \n  white-space: nowrap; \n  overflow: hidden; \n  text-overflow: ellipsis; \n}\n\n.dept-item.active .dept-name { \n  color: var(--el-color-primary); \n}\n\n.dept-config-pane {\n  flex: 1;\n  padding: 20px;\n  overflow-y: auto;\n}\n\n.empty-selection, .empty-list { \n  padding-top: 100px; \n  display: flex; \n  justify-content: center; \n}\n\n.perm-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n\n.perm-list .el-checkbox {\n  width: calc(50% - 8px);\n  margin: 0;\n}\n</style>\n"],"version":3}