{"file":"media-C2x210Ez.js","mappings":"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","names":[],"sources":["../../../../api/admin/media.ts"],"sourcesContent":["import { getAdminSupabaseClient } from '@/utils/supabase-admin'\n\nexport interface AdminImageCategory {\n    id: string\n    name: string\n    sort_order: number\n    created_at: string\n}\n\nexport interface AdminImage {\n    id: string\n    name: string\n    url: string\n    category_id: string | null\n    created_at: string\n    category?: AdminImageCategory\n}\n\nexport interface AdminBanner {\n    id: string\n    image_id: string\n    title: string\n    link: string\n    sort_order: number\n    status: 'on' | 'off'\n    created_at: string\n    image?: AdminImage\n}\n\nexport const adminImageCategoryApi = {\n    /**\n     * 获取图片分类列表\n     */\n    async getCategories(): Promise<{ success: boolean; categories: AdminImageCategory[]; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { data, error } = await client\n            .from('image_categories')\n            .select('*')\n            .order('sort_order', { ascending: true })\n\n        if (error) return { success: false, categories: [], error: error.message }\n        return { success: true, categories: data || [] }\n    },\n\n    /**\n     * 创建图片分类\n     */\n    async createCategory(name: string): Promise<{ success: boolean; category?: AdminImageCategory; error?: string }> {\n        const client = getAdminSupabaseClient()\n        // 获取当前最大排序\n        const { data: maxOrder } = await client\n            .from('image_categories')\n            .select('sort_order')\n            .order('sort_order', { ascending: false })\n            .limit(1)\n            .single()\n\n        const nextOrder = (maxOrder?.sort_order || 0) + 1\n\n        const { data: category, error } = await client\n            .from('image_categories')\n            .insert({ name, sort_order: nextOrder })\n            .select()\n            .single()\n\n        if (error) return { success: false, error: error.message }\n        return { success: true, category }\n    },\n\n    /**\n     * 删除图片分类\n     */\n    async deleteCategory(id: string): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n\n        // 检查该分类下是否有图片\n        const { count } = await client\n            .from('images')\n            .select('*', { count: 'exact', head: true })\n            .eq('category_id', id)\n\n        if (count && count > 0) {\n            return { success: false, error: '该分类下有图片，无法删除' }\n        }\n\n        const { error } = await client\n            .from('image_categories')\n            .delete()\n            .eq('id', id)\n\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    }\n}\n\nexport const adminImageApi = {\n    /**\n     * 获取图片列表\n     */\n    async getImages(params?: { category_id?: string; keyword?: string }): Promise<{ success: boolean; images: AdminImage[]; error?: string }> {\n        const client = getAdminSupabaseClient()\n        let query = client.from('images').select(`\n            *,\n            category:image_categories(*)\n        `)\n\n        if (params?.category_id) query = query.eq('category_id', params.category_id)\n        if (params?.keyword) query = query.ilike('name', `%${params.keyword}%`)\n\n        const { data, error } = await query.order('created_at', { ascending: false })\n        if (error) return { success: false, images: [], error: error.message }\n        return { success: true, images: data || [] }\n    },\n\n    /**\n     * 创建图片记录\n     */\n    async createImage(data: { name: string; url: string; category_id?: string }): Promise<{ success: boolean; image?: AdminImage; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { data: image, error } = await client.from('images').insert(data).select().single()\n        if (error) return { success: false, error: error.message }\n        return { success: true, image }\n    },\n\n    /**\n     * 更新图片信息\n     */\n    async updateImage(id: string, data: Partial<AdminImage>): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client.from('images').update(data).eq('id', id)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    /**\n     * 删除图片（单个）\n     */\n    async deleteImage(id: string): Promise<{ success: boolean; error?: string }> {\n        return this.deleteImages([id])\n    },\n\n    /**\n     * 批量删除图片\n     */\n    async deleteImages(ids: string[]): Promise<{ success: boolean; error?: string }> {\n        if (!ids.length) return { success: true }\n\n        const client = getAdminSupabaseClient()\n\n        // 1. 获取图片信息以拿到 URL\n        const { data: images, error: fetchError } = await client\n            .from('images')\n            .select('url')\n            .in('id', ids)\n\n        if (fetchError) return { success: false, error: fetchError.message }\n\n        // 2. 从 R2 URL 提取文件路径\n        const filePaths = images\n            .map(img => {\n                try {\n                    const url = new URL(img.url)\n                    // 移除开头的 /\n                    return url.pathname.startsWith('/') ? url.pathname.slice(1) : url.pathname\n                } catch {\n                    // 如果不是有效 URL，尝试直接分割\n                    const parts = img.url.split('/')\n                    // 取最后两段 (folder/filename)\n                    return parts.slice(-2).join('/')\n                }\n            })\n            .filter(Boolean)\n\n        // 3. 调用 delete-r2 Edge Function 删除 R2 文件\n        if (filePaths.length > 0) {\n            try {\n                // 获取 Admin Token\n                const { getAdminAuthToken } = await import('@/utils/supabase-admin')\n                const token = await getAdminAuthToken()\n\n                if (token) {\n                    const { EDGE_FUNCTIONS_URL } = await import('@/utils/supabase')\n                    const response = await fetch(`${EDGE_FUNCTIONS_URL}/delete-r2`, {\n                        method: 'POST',\n                        headers: {\n                            'Authorization': `Bearer ${token}`,\n                            'Content-Type': 'application/json'\n                        },\n                        body: JSON.stringify({ paths: filePaths })\n                    })\n\n                    if (!response.ok) {\n                        const result = await response.json()\n                        console.error('Failed to delete files from R2:', result.error)\n                    }\n                }\n            } catch (e) {\n                console.error('R2 delete request failed:', e)\n            }\n        }\n\n        // 4. 删除数据库记录\n        const { error } = await client.from('images').delete().in('id', ids)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    }\n}\n\nexport const adminBannerApi = {\n    /**\n     * 获取轮播图列表\n     */\n    async getBanners(): Promise<{ success: boolean; banners: AdminBanner[]; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { data, error } = await client\n            .from('banners')\n            .select(`\n                *,\n                image:images(*)\n            `)\n            .order('sort_order', { ascending: true })\n\n        if (error) return { success: false, banners: [], error: error.message }\n        return { success: true, banners: data || [] }\n    },\n\n    /**\n     * 添加轮播图\n     */\n    async createBanner(data: { image_id: string; title?: string; link?: string; sort_order?: number }): Promise<{ success: boolean; banner?: AdminBanner; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { data: banner, error } = await client\n            .from('banners')\n            .insert({\n                ...data,\n                status: 'on'\n            })\n            .select()\n            .single()\n\n        if (error) return { success: false, error: error.message }\n        return { success: true, banner }\n    },\n\n    /**\n     * 更新轮播图状态/排序\n     */\n    async updateBanner(id: string, data: Partial<AdminBanner>): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client.from('banners').update(data).eq('id', id)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    /**\n     * 删除轮播图\n     */\n    async deleteBanner(id: string): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client.from('banners').delete().eq('id', id)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    }\n}\n\nexport const adminSettingsApi = {\n    /**\n     * 获取 R2 配置\n     */\n    async getR2Settings(): Promise<{\n        success: boolean\n        settings?: {\n            R2_ACCOUNT_ID: string\n            R2_ACCESS_KEY_ID: string\n            R2_SECRET_ACCESS_KEY: string\n            R2_BUCKET_NAME: string\n            R2_PUBLIC_BASE_URL: string\n        }\n        error?: string\n    }> {\n        const client = getAdminSupabaseClient()\n\n        try {\n            const { data, error } = await client\n                .from('system_settings')\n                .select('key, value')\n                .in('key', ['R2_ACCOUNT_ID', 'R2_ACCESS_KEY_ID', 'R2_SECRET_ACCESS_KEY', 'R2_BUCKET_NAME', 'R2_PUBLIC_BASE_URL'])\n\n            if (error) {\n                // Return default\n                return {\n                    success: true,\n                    settings: {\n                        R2_ACCOUNT_ID: '',\n                        R2_ACCESS_KEY_ID: '',\n                        R2_SECRET_ACCESS_KEY: '',\n                        R2_BUCKET_NAME: 'fantula2601',\n                        R2_PUBLIC_BASE_URL: 'https://img.fantula.com'\n                    }\n                }\n            }\n\n            const settings: Record<string, string> = {\n                R2_ACCOUNT_ID: '',\n                R2_ACCESS_KEY_ID: '',\n                R2_SECRET_ACCESS_KEY: '',\n                R2_BUCKET_NAME: 'fantula2601',\n                R2_PUBLIC_BASE_URL: 'https://img.fantula.com'\n            }\n\n            data?.forEach((item: { key: string; value: string }) => {\n                settings[item.key] = item.value\n                // Mask secret\n                if (item.key === 'R2_SECRET_ACCESS_KEY' && item.value) {\n                    settings[item.key] = item.value.slice(0, 4) + '****' + item.value.slice(-4)\n                }\n            })\n\n            return { success: true, settings: settings as any }\n        } catch (e: any) {\n            return { success: false, error: e.message }\n        }\n    },\n\n    /**\n     * 更新 R2 配置\n     */\n    async updateR2Settings(settings: {\n        R2_ACCOUNT_ID: string\n        R2_ACCESS_KEY_ID: string\n        R2_SECRET_ACCESS_KEY?: string  // Optional\n        R2_BUCKET_NAME: string\n        R2_PUBLIC_BASE_URL: string\n    }): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n\n        try {\n            const updates = Object.entries(settings)\n                .filter(([_, value]) => value !== undefined && value !== '')\n                .map(([key, value]) => ({\n                    key,\n                    value,\n                    updated_at: new Date().toISOString()\n                }))\n\n            if (updates.length === 0) {\n                return { success: true }\n            }\n            const { error } = await client\n                .from('system_settings')\n                .upsert(updates, { onConflict: 'key' })\n\n            if (error) {\n                return { success: false, error: error.message }\n            }\n\n            return { success: true }\n        } catch (e: any) {\n            return { success: false, error: e.message }\n        }\n    }\n}\n"],"version":3}