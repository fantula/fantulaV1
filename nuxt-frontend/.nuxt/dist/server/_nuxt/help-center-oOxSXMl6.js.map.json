{"file":"help-center-oOxSXMl6.js","mappings":"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","names":[],"sources":["../../../../api/admin/help-center.ts"],"sourcesContent":["import { getAdminSupabaseClient } from '@/utils/supabase-admin'\nimport type { Article, Category } from '@/api/community'\n\nexport interface AdminFaqCategory {\n    id: string\n    name: string\n    sort_order: number\n    is_active: boolean\n    is_checkout_visible: boolean\n    created_at: string\n}\n\nexport interface AdminFaq {\n    id: string\n    category_id: string | null\n    question: string\n    answer: string\n    product_id: string | null\n    sort_order: number\n    is_active: boolean\n    created_at: string\n    category?: AdminFaqCategory\n    product?: any // AdminProduct inferred\n}\n\nexport const adminFaqApi = {\n    // --- FAQ Category Management ---\n\n    async getCategories(): Promise<{ success: boolean; categories: AdminFaqCategory[]; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { data, error } = await client\n            .from('faq_categories')\n            .select('*')\n            .order('sort_order', { ascending: true })\n\n        if (error) return { success: false, categories: [], error: error.message }\n        return { success: true, categories: data || [] }\n    },\n\n    async createCategory(data: { name: string; sort_order: number; is_checkout_visible?: boolean }): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client\n            .from('faq_categories')\n            .insert({\n                name: data.name,\n                sort_order: data.sort_order,\n                is_active: true,\n                is_checkout_visible: data.is_checkout_visible || false\n            })\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    async updateCategory(id: string, data: { name?: string; sort_order?: number; is_active?: boolean; is_checkout_visible?: boolean }): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client\n            .from('faq_categories')\n            .update(data)\n            .eq('id', id)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    async deleteCategory(id: string): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        // Check if has FAQs\n        const { count } = await client.from('faqs').select('*', { count: 'exact', head: true }).eq('category_id', id)\n        if (count && count > 0) {\n            return { success: false, error: `无法删除：该分类下有 ${count} 个问题，请先移除问题` }\n        }\n\n        const { error } = await client.from('faq_categories').delete().eq('id', id)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    // --- FAQ Management ---\n\n    async getFaqs(params?: {\n        category_id?: string\n        keyword?: string\n        page?: number\n        page_size?: number\n    }): Promise<{ success: boolean; faqs: AdminFaq[]; total: number; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const page = params?.page || 1\n        const pageSize = params?.page_size || 20\n        const offset = (page - 1) * pageSize\n\n        let query = client\n            .from('faqs')\n            .select(`\n                *,\n                category:faq_categories(id, name),\n                product:products(id, product_name)\n            `, { count: 'exact' })\n\n        if (params?.category_id) {\n            query = query.eq('category_id', params.category_id)\n        }\n        if (params?.keyword) {\n            query = query.ilike('question', `%${params.keyword}%`)\n        }\n\n        query = query\n            .order('sort_order', { ascending: true })\n            .range(offset, offset + pageSize - 1)\n\n        const { data, error, count } = await query\n\n        if (error) return { success: false, faqs: [], total: 0, error: error.message }\n        return { success: true, faqs: data || [], total: count || 0 }\n    },\n\n    async getFaqById(id: string): Promise<{ success: boolean; faq?: AdminFaq; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { data, error } = await client\n            .from('faqs')\n            .select(`\n                *,\n                product:products(id, product_name)\n            `)\n            .eq('id', id)\n            .single()\n\n        if (error) return { success: false, error: error.message }\n        return { success: true, faq: data }\n    },\n\n    async createFaq(data: {\n        category_id?: string\n        question: string\n        answer: string\n        product_id?: string\n        sort_order?: number\n        is_active?: boolean\n    }): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client.from('faqs').insert({\n            category_id: data.category_id || null,\n            question: data.question,\n            answer: data.answer,\n            product_id: data.product_id || null,\n            sort_order: data.sort_order || 0,\n            is_active: data.is_active !== false\n        })\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    async updateFaq(id: string, data: {\n        category_id?: string\n        question?: string\n        answer?: string\n        product_id?: string\n        sort_order?: number\n        is_active?: boolean\n    }): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client.from('faqs').update({\n            category_id: data.category_id || null,\n            question: data.question,\n            answer: data.answer,\n            product_id: data.product_id || null,\n            sort_order: data.sort_order,\n            is_active: data.is_active\n        }).eq('id', id)\n\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    },\n\n    async deleteFaq(id: string): Promise<{ success: boolean; error?: string }> {\n        const client = getAdminSupabaseClient()\n        const { error } = await client.from('faqs').delete().eq('id', id)\n        if (error) return { success: false, error: error.message }\n        return { success: true }\n    }\n}\n\nexport const adminArticleApi = {\n    // Articles\n    async getArticles(page = 1, pageSize = 20) {\n        const client = getAdminSupabaseClient()\n\n        const from = (page - 1) * pageSize\n        const to = from + pageSize - 1\n\n        const { data, count, error } = await client\n            .from('community_articles')\n            .select('*', { count: 'exact' })\n            .order('created_at', { ascending: false })\n            .range(from, to)\n\n        return { data, total: count, error }\n    },\n\n    async createArticle(article: Partial<Article>) {\n        const client = getAdminSupabaseClient()\n        return await client.from('community_articles').insert([article]).select()\n    },\n\n    async updateArticle(id: string, updates: Partial<Article>) {\n        const client = getAdminSupabaseClient()\n        return await client.from('community_articles').update(updates).eq('id', id).select()\n    },\n\n    async deleteArticle(id: string) {\n        const client = getAdminSupabaseClient()\n        return await client.from('community_articles').delete().eq('id', id)\n    },\n\n    // Get single article by ID (admin - can fetch drafts)\n    async getArticleById(id: string) {\n        const client = getAdminSupabaseClient()\n        const { data, error } = await client\n            .from('community_articles')\n            .select('*')\n            .eq('id', id)\n            .single()\n\n        if (error) {\n            return { success: false, data: null, msg: error.message }\n        }\n        return { success: true, data, msg: '' }\n    },\n\n    // Categories\n    async getCategories() {\n        const client = getAdminSupabaseClient()\n        return await client\n            .from('community_categories')\n            .select('*')\n            .order('sort_order', { ascending: true })\n    },\n\n    async createCategory(category: Partial<Category>) {\n        const client = getAdminSupabaseClient()\n        return await client.from('community_categories').insert([category]).select()\n    },\n\n    async updateCategory(id: string, updates: Partial<Category>) {\n        const client = getAdminSupabaseClient()\n        return await client.from('community_categories').update(updates).eq('id', id).select()\n    },\n\n    async deleteCategory(id: string) {\n        const client = getAdminSupabaseClient()\n        return await client.from('community_categories').delete().eq('id', id)\n    }\n}\n"],"version":3}