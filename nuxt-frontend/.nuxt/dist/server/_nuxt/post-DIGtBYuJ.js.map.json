{"file":"post-DIGtBYuJ.js","mappings":"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","names":["_ssrGetDirectiveProps","_withCtx","_ssrRenderList","_openBlock","_createBlock","_createCommentVNode","_createVNode","_toDisplayString","_Fragment","_renderList","_ssrRenderComponent","_unref","Edit","Plus","_createTextVNode"],"sources":["../../../../pages/_mgmt_9Xfa3/article/post.vue"],"sourcesContent":["<template>\n  <div class=\"admin-page-post\">\n    <div class=\"page-header\">\n      <h2 class=\"page-title\">{{ isEdit ? '编辑文章' : '发布文章' }}</h2>\n      <el-button @click=\"router.back()\">返回列表</el-button>\n    </div>\n\n    <div class=\"form-container\">\n      <el-form :model=\"form\" label-width=\"120px\" ref=\"formRef\" :rules=\"rules\" v-loading=\"loading\">\n        <el-form-item label=\"文章标题\" prop=\"title\">\n          <el-input v-model=\"form.title\" placeholder=\"请输入文章标题\" />\n        </el-form-item>\n\n        <el-form-item label=\"所属分类\" prop=\"category\">\n          <el-select v-model=\"form.category\" placeholder=\"请选择分类\">\n            <el-option\n              v-for=\"item in categories\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            >\n              <span style=\"float: left\">{{ item.icon }} {{ item.name }}</span>\n              <span style=\"float: right; color: var(--el-text-color-placeholder); font-size: 13px\" v-if=\"!item.is_active\">已禁用</span>\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"封面图片\" prop=\"cover_image\">\n          <div class=\"image-select-container\">\n            <div \n              v-if=\"form.cover_image\" \n              class=\"cover-preview\"\n              @click=\"showImagePicker = true\"\n            >\n              <img :src=\"form.cover_image\" class=\"cover-image\" />\n              <div class=\"cover-mask\">\n                <el-icon><Edit /></el-icon>\n                <span>更换图片</span>\n              </div>\n            </div>\n            <div \n              v-else \n              class=\"cover-uploader\"\n              @click=\"showImagePicker = true\"\n            >\n              <el-icon class=\"cover-uploader-icon\"><Plus /></el-icon>\n              <span>选择封面</span>\n            </div>\n            <div class=\"tip-text\">建议尺寸 800x450 (16:9)，点击选择或上传</div>\n          </div>\n        </el-form-item>\n\n        <el-form-item label=\"视频链接\" prop=\"video_url\">\n          <el-input v-model=\"form.video_url\" placeholder=\"支持 Bilibili (BV号) 或 YouTube 链接\">\n            <template #append>\n              <el-button @click=\"checkVideo\">预览</el-button>\n            </template>\n          </el-input>\n          <div class=\"tip-text\">示例: https://www.bilibili.com/video/BVxxx 或 https://youtu.be/xxx</div>\n          \n          <div v-if=\"videoPreviewUrl\" class=\"video-preview\">\n            <iframe \n              :src=\"videoPreviewUrl\" \n              scrolling=\"no\" \n              border=\"0\" \n              frameborder=\"no\" \n              framespacing=\"0\" \n              allowfullscreen=\"true\">\n            </iframe>\n          </div>\n        </el-form-item>\n\n        <el-form-item label=\"简短描述\" prop=\"description\">\n          <el-input \n            v-model=\"form.description\" \n            type=\"textarea\" \n            :rows=\"3\" \n            placeholder=\"文章摘要，用于列表展示\" \n          />\n        </el-form-item>\n\n        <el-form-item label=\"详细内容\" prop=\"content\">\n          <el-input \n            v-model=\"form.content\" \n            type=\"textarea\" \n            :rows=\"15\" \n            placeholder=\"支持 Markdown 格式。如果填写了视频链接，视频将显示在内容上方。\" \n          />\n        </el-form-item>\n\n        <el-form-item label=\"发布状态\">\n          <el-switch v-model=\"form.is_published\" active-text=\"立即发布\" inactive-text=\"存为草稿\" />\n        </el-form-item>\n\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm\">保存提交</el-button>\n          <el-button @click=\"router.back()\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n\n    <!-- Image Picker Component -->\n    <AdminImagePicker v-model=\"showImagePicker\" @select=\"handleImageSelect\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, onMounted, computed, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { Plus, Edit } from '@element-plus/icons-vue'\nimport { ElMessage } from 'element-plus'\nimport { adminCommunityApi, communityApi, type Category } from '@/api/community'\n// Explicitly import AdminImagePicker\nimport AdminImagePicker from '@/components/admin/AdminImagePicker.vue'\n\nconst router = useRouter()\nconst route = useRoute()\nconst formRef = ref()\nconst loading = ref(false)\nconst categories = ref<Category[]>([])\nconst showImagePicker = ref(false)\n\nconst isEdit = computed(() => !!route.query.id)\n\nconst form = reactive({\n  title: '',\n  category: '',\n  cover_image: '',\n  video_url: '',\n  description: '',\n  content: '',\n  is_published: false\n})\n\nconst rules = {\n  title: [{ required: true, message: '请输入标题', trigger: 'blur' }],\n  category: [{ required: true, message: '请选择分类', trigger: 'change' }]\n}\n\nconst fetchCategories = async () => {\n  try {\n    const { data } = await adminCommunityApi.getCategories()\n    categories.value = data || []\n  } catch (error) {\n    console.error('Failed to fetch categories', error)\n  }\n}\n\nconst handleImageSelect = (url: string) => {\n  form.cover_image = url\n  ElMessage.success('已选择图片')\n}\n\nconst videoPreviewUrl = ref('')\n\nconst checkVideo = () => {\n  const url = form.video_url\n  if (!url) {\n    videoPreviewUrl.value = ''\n    return\n  }\n  \n  const b_match = url.match(/(BV[a-zA-Z0-9]+)/)\n  if (b_match) {\n    videoPreviewUrl.value = `//player.bilibili.com/player.html?bvid=${b_match[1]}&page=1&high_quality=1&danmaku=0`\n    return\n  }\n\n  const y_match = url.match(/(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([\\w-]+)/)\n  if (y_match) {\n    videoPreviewUrl.value = `https://www.youtube.com/embed/${y_match[1]}?rel=0&modestbranding=1`\n    return\n  }\n  \n  ElMessage.warning('未能识别视频链接格式，请检查')\n  videoPreviewUrl.value = ''\n}\n\nconst fetchDetail = async () => {\n  if (!isEdit.value) return\n  loading.value = true\n  try {\n    // Use admin API to fetch drafts as well\n    const { success, data, msg } = await adminCommunityApi.getArticleById(route.query.id as string)\n    if (!success) throw new Error(msg)\n    \n    // Fill form\n    Object.assign(form, {\n      title: data.title,\n      category: data.category,\n      cover_image: data.cover_image,\n      video_url: data.video_url,\n      description: data.description,\n      content: data.content,\n      is_published: data.is_published\n    })\n    checkVideo()\n  } catch (error: any) {\n    ElMessage.error('获取详情失败: ' + error.message)\n  } finally {\n    loading.value = false\n  }\n}\n\nconst submitForm = async () => {\n  if (!formRef.value) return\n  await formRef.value.validate(async (valid: boolean) => {\n    if (valid) {\n      loading.value = true\n      try {\n        if (isEdit.value) {\n          const { error } = await adminCommunityApi.updateArticle(route.query.id as string, form)\n          if (error) throw error\n          ElMessage.success('更新成功')\n        } else {\n          const { error } = await adminCommunityApi.createArticle(form)\n          if (error) throw error\n          ElMessage.success('发布成功')\n        }\n        router.push('/_mgmt_9Xfa3/article')\n      } catch (error: any) {\n        ElMessage.error('提交失败: ' + error.message)\n      } finally {\n        loading.value = false\n      }\n    }\n  })\n}\n\nonMounted(() => {\n  fetchCategories()\n  fetchDetail()\n})\n</script>\n\n<style scoped>\n.admin-page-post {\n  padding: 20px;\n  background: var(--el-bg-color);\n  border-radius: 8px;\n  min-height: calc(100vh - 100px);\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30px;\n  padding-bottom: 20px;\n  border-bottom: 1px solid var(--el-border-color-lighter);\n}\n\n.form-container {\n  max-width: 800px;\n}\n\n/* Image Selector Styles */\n.image-select-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.cover-uploader {\n  border: 1px dashed var(--el-border-color);\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n  width: 240px;\n  height: 135px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  background-color: var(--el-fill-color-light);\n  transition: all 0.3s;\n}\n\n.cover-uploader:hover {\n  border-color: var(--el-color-primary);\n  background-color: var(--el-color-primary-light-9);\n}\n\n.cover-uploader-icon {\n  font-size: 28px;\n  color: var(--el-text-color-secondary);\n  margin-bottom: 8px;\n}\n\n.cover-preview {\n  width: 240px;\n  height: 135px;\n  border-radius: 6px;\n  overflow: hidden;\n  position: relative;\n  cursor: pointer;\n  border: 1px solid var(--el-border-color);\n}\n\n.cover-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.cover-mask {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: var(--el-mask-color);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: #fff;\n  opacity: 0;\n  transition: opacity 0.3s;\n}\n\n.cover-preview:hover .cover-mask {\n  opacity: 1;\n}\n\n.tip-text {\n  font-size: 12px;\n  color: var(--el-text-color-secondary);\n}\n\n.video-preview {\n  margin-top: 10px;\n  width: 100%;\n  max-width: 480px;\n  height: 270px;\n  background: #000;\n}\n.video-preview iframe {\n  width: 100%;\n  height: 100%;\n}\n</style>\n"],"version":3}