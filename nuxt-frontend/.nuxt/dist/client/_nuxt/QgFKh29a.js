const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BPs5C_y9.js","./o2XBa361.js","./entry.DI7xQWfr.css"])))=>i.map(i=>d[i]);
import{f as U,r as c,J as h,G as w,w as v,o,a as i,i as $,c as m,n as C,k as V,t as I,F as x,D as z,b as g,d as F,ax as R,_ as G}from"./o2XBa361.js";import{E as J}from"./-Yx_0iEM.js";import{E as O}from"./DFiWfk7u.js";import{E as j}from"./BTJpnMK3.js";import{E as q}from"./C1T5KPmY.js";import{E as H}from"./CziALilw.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{c as f}from"./Di05QSSe.js";import{v as K}from"./BwD4Hz0h.js";const M={class:"picker-container"},Q={class:"picker-sidebar"},W=["onClick"],X={class:"picker-main"},Y={class:"picker-toolbar"},Z={class:"picker-grid"},ee=["onClick"],ae={class:"picker-img-name"},te=U({__name:"AdminImagePicker",props:{modelValue:{type:Boolean}},emits:["update:modelValue","select"],setup(b,{emit:B}){const k=b,y=B,l=c(k.modelValue),r=c(!1),u=c([]),p=c([]),s=c("");h(()=>k.modelValue,e=>{l.value=e,e&&(A(),d())}),h(l,e=>{y("update:modelValue",e)});const A=async()=>{if(p.value.length>0)return;const e=await f.imageCategory.getCategories();e.success&&(p.value=e.categories)},d=async()=>{r.value=!0;const e=await f.image.getImages({category_id:s.value||void 0});e.success&&(u.value=e.images),r.value=!1},E=e=>{y("select",e),l.value=!1},D=async e=>{r.value=!0;try{const{uploadImageToStorage:t}=await R(async()=>{const{uploadImageToStorage:_}=await import("./BPs5C_y9.js");return{uploadImageToStorage:_}},__vite__mapDeps([0,1,2]),import.meta.url),n=await t(e.raw);n.success&&(await f.image.createImage({name:e.name,url:n.url,category_id:s.value||void 0}),E(n.url),d())}finally{r.value=!1}};return(e,t)=>{const n=J,_=O,N=j,P=q,T=H,L=K;return o(),w(T,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=a=>l.value=a),title:"图库选择",width:"800px","append-to-body":"","destroy-on-close":"",class:"picker-dialog"},{default:v(()=>[i("div",M,[i("div",Q,[i("div",{class:C(["picker-cat-item",{active:s.value===""}]),onClick:t[0]||(t[0]=a=>{s.value="",d()})},"全部图片",2),(o(!0),m(x,null,V(p.value,a=>(o(),m("div",{key:a.id,class:C(["picker-cat-item",{active:s.value===a.id}]),onClick:S=>{s.value=a.id,d()}},I(a.name),11,W))),128))]),$((o(),m("div",X,[i("div",Y,[g(_,{action:"#","auto-upload":!1,"show-file-list":!1,"on-change":D},{default:v(()=>[g(n,{type:"primary",size:"small"},{default:v(()=>[...t[2]||(t[2]=[F("上传新图片",-1)])]),_:1})]),_:1})]),i("div",Z,[(o(!0),m(x,null,V(u.value,a=>(o(),m("div",{key:a.id,class:"picker-img-card",onClick:S=>E(a.url)},[g(N,{src:a.url,fit:"cover"},null,8,["src"]),i("div",ae,I(a.name),1)],8,ee))),128))]),u.value.length===0?(o(),w(P,{key:0,description:"暂无图片"})):z("",!0)])),[[L,r.value]])])]),_:1},8,["modelValue"])}}}),fe=G(te,[["__scopeId","data-v-dc628e2a"]]);export{fe as A};
