import{f as P,r as p,g as R,am as M,h as X,c as _,a as i,i as G,b as r,w as a,t as v,a1 as T,B as n,C as h,o as u,d as m,E as j,l as H,a2 as J,F as C,k as O,G as U,_ as K}from"./o2XBa361.js";import{E as Q}from"./-Yx_0iEM.js";import{E as W}from"./1SfIsks3.js";import{E as Y,a as Z}from"./0BTaD5f-.js";import{a as ee,E as te}from"./CrjkcmUY.js";import{E as oe}from"./DytS51kl.js";import{E as re}from"./Cq9RPQ5L.js";import{E as ae}from"./C8ZH7i_a.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{b as se}from"./Di05QSSe.js";import{v as le}from"./BwD4Hz0h.js";import{a as g}from"./Ct7sd9tI.js";import"./Culj45X8.js";import"./Dnj8X3EN.js";import"./CqX7ZdKI.js";import"./Dlk0BVst.js";import"./BB_Ol6Sd.js";import"./DVQwC1Y0.js";import"./Bh6H2ams.js";import"./Cq9Fpw4b.js";import"./BlW_46uR.js";import"./C9zJf5rn.js";import"./qVmxJdp3.js";import"./DtTI1xRr.js";import"./t2w4jifC.js";import"./ClnTspdU.js";import"./DC3lfPj1.js";import"./B8yeDp5P.js";import"./B_FoF6yT.js";import"./Ds34GQx2.js";import"./Dzr5IOAO.js";import"./Z6faUBN3.js";import"./KSqZSeJ0.js";import"./CQuNCUIC.js";import"./BHSqheQV.js";import"./DwwA_QlG.js";import"./Bdid5VjX.js";import"./XmVVhx5S.js";import"./CM1YTunQ.js";const ie={class:"faq-post-page"},de={class:"page-header"},ne={class:"header-left"},ue={class:"page-title"},pe={class:"form-card"},me={class:"product-option"},ce={class:"product-id-sub"},fe=P({__name:"post",setup(_e){const V=T(),q=h(),y=p(!1),b=p(!1),c=R(()=>!!V.query.id),I=p([]),f=p([]),w=p(!1),t=M({id:"",question:"",answer:"",categoryId:"",productId:"",sortOrder:0,isActive:!0}),x=async()=>{y.value=!0;try{const l=await g.getCategories();if(l.success&&(I.value=l.categories),c.value){const e=V.query.id,s=await g.getFaqById(e);s.success&&s.faq?(t.id=s.faq.id,t.question=s.faq.question,t.answer=s.faq.answer,t.categoryId=s.faq.category_id||"",t.productId=s.faq.product_id||"",t.sortOrder=s.faq.sort_order,t.isActive=s.faq.is_active,s.faq.product&&(f.value=[s.faq.product])):(n.error("加载问题数据失败"),q.back())}}finally{y.value=!1}},z=async l=>{if(l){w.value=!0;try{const e=await se.getProducts({keyword:l,page_size:10});e.success&&(f.value=e.products)}finally{w.value=!1}}else f.value=[]},D=async()=>{if(!t.question||!t.answer||!t.categoryId){n.warning("请填写完整信息");return}b.value=!0;try{const l={question:t.question,answer:t.answer,category_id:t.categoryId,product_id:t.productId||void 0,sort_order:t.sortOrder,is_active:t.isActive};if(c.value){const e=await g.updateFaq(t.id,l);e.success?(n.success("更新成功"),q.push("/_mgmt_9Xfa3/faq")):n.error(e.error||"更新失败")}else{const e=await g.createFaq(l);e.success?(n.success("创建成功"),q.push("/_mgmt_9Xfa3/faq")):n.error(e.error||"创建失败")}}finally{b.value=!1}};return X(()=>{x()}),(l,e)=>{const s=j,E=Q,k=W,d=Z,F=te,A=ee,B=oe,N=re,S=ae,$=Y,L=le;return u(),_("div",ie,[i("div",de,[i("div",ne,[r(E,{link:"",onClick:e[0]||(e[0]=o=>l.$router.back())},{default:a(()=>[r(s,null,{default:a(()=>[r(H(J))]),_:1}),e[8]||(e[8]=m(" 返回列表 ",-1))]),_:1}),i("h2",ue,v(c.value?"编辑问题":"创建问题"),1)])]),G((u(),_("div",pe,[r($,{model:t,"label-width":"120px",class:"faq-form"},{default:a(()=>[r(d,{label:"问题标题",required:""},{default:a(()=>[r(k,{modelValue:t.question,"onUpdate:modelValue":e[1]||(e[1]=o=>t.question=o),placeholder:"请输入问题，例如：如何进行虚拟充值？",size:"large"},null,8,["modelValue"])]),_:1}),r(d,{label:"问题分类",required:""},{default:a(()=>[r(A,{modelValue:t.categoryId,"onUpdate:modelValue":e[2]||(e[2]=o=>t.categoryId=o),placeholder:"请选择分类",style:{width:"100%"}},{default:a(()=>[(u(!0),_(C,null,O(I.value,o=>(u(),U(F,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(B,{"border-style":"dashed","content-position":"left"},{default:a(()=>[...e[9]||(e[9]=[m("详细解答",-1)])]),_:1}),r(d,{label:"答案内容",required:""},{default:a(()=>[r(k,{modelValue:t.answer,"onUpdate:modelValue":e[3]||(e[3]=o=>t.answer=o),type:"textarea",rows:8,placeholder:"请输入详细解答..."},null,8,["modelValue"]),e[10]||(e[10]=i("div",{class:"form-tip"},"支持基本的文本内容，将直接显示在客户端。",-1))]),_:1}),r(B,{"border-style":"dashed","content-position":"left"},{default:a(()=>[...e[11]||(e[11]=[m("高级配置",-1)])]),_:1}),r(d,{label:"关联商品"},{default:a(()=>[r(A,{modelValue:t.productId,"onUpdate:modelValue":e[4]||(e[4]=o=>t.productId=o),filterable:"",remote:"",clearable:"",placeholder:"搜索并选择关联的商品（可选）","remote-method":z,loading:w.value,style:{width:"100%"}},{default:a(()=>[(u(!0),_(C,null,O(f.value,o=>(u(),U(F,{key:o.id,label:o.product_name,value:o.id},{default:a(()=>[i("div",me,[i("span",null,v(o.product_name),1),i("span",ce,v(o.id),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),e[12]||(e[12]=i("div",{class:"form-tip"}," 绑定后，该问题将优先展示在对应商品的详情页中。 ",-1))]),_:1}),r(d,{label:"排序权重"},{default:a(()=>[r(N,{modelValue:t.sortOrder,"onUpdate:modelValue":e[5]||(e[5]=o=>t.sortOrder=o),min:0},null,8,["modelValue"]),e[13]||(e[13]=i("div",{class:"form-tip"},"数值越小越靠前",-1))]),_:1}),r(d,{label:"是否启用"},{default:a(()=>[r(S,{modelValue:t.isActive,"onUpdate:modelValue":e[6]||(e[6]=o=>t.isActive=o)},null,8,["modelValue"])]),_:1}),r(d,null,{default:a(()=>[r(E,{type:"primary",onClick:D,loading:b.value,size:"large"},{default:a(()=>[m(v(c.value?"保存修改":"立即发布"),1)]),_:1},8,["loading"]),r(E,{onClick:e[7]||(e[7]=o=>l.$router.back()),size:"large"},{default:a(()=>[...e[14]||(e[14]=[m("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])),[[L,y.value]])])}}}),ut=K(fe,[["__scopeId","data-v-0de8c673"]]);export{ut as default};
