import{ad as i,dM as a}from"./gYbOYKrZ.js";const f={async getArticles(e="all",t=1,r=12){let s=i().from("community_articles").select("*",{count:"exact"}).eq("is_published",!0).order("created_at",{ascending:!1});e!=="all"&&(s=s.eq("category",e));const n=(t-1)*r,o=n+r-1,{data:l,error:u,count:m}=await s.range(n,o);return u?(console.error("Error fetching articles:",u),{success:!1,data:[],total:0}):{success:!0,data:l?.map(d=>({...d,author:{name:"官方客服",avatar:"/images/service-avatar.png"}})),total:m||0}},async getCategories(){const e=i(),{data:t,error:r}=await e.from("community_categories").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});return r?(console.error("Error fetching categories:",r),{success:!1,data:[]}):{success:!0,data:t}},async getArticleDetail(e){const t=i(),{data:r,error:c}=await t.from("community_articles").select("*").eq("id",e).single();return c?(console.error("Error fetching article detail:",c),{success:!1,msg:c.message}):(this.incrementViews(e),{success:!0,data:{...r,author:{name:"官方客服",avatar:"/images/service-avatar.png"}}})},async incrementViews(e){await i().rpc("increment_article_views",{article_id:e})}},_={async getArticles(e=1,t=20){const r=a(),c=(e-1)*t,s=c+t-1,{data:n,count:o,error:l}=await r.from("community_articles").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(c,s);return{data:n,total:o,error:l}},async createArticle(e){return await a().from("community_articles").insert([e]).select()},async updateArticle(e,t){return await a().from("community_articles").update(t).eq("id",e).select()},async deleteArticle(e){return await a().from("community_articles").delete().eq("id",e)},async getArticleById(e){const t=a(),{data:r,error:c}=await t.from("community_articles").select("*").eq("id",e).single();return c?{success:!1,data:null,msg:c.message}:{success:!0,data:r,msg:""}},async getCategories(){return await a().from("community_categories").select("*").order("sort_order",{ascending:!0})},async createCategory(e){return await a().from("community_categories").insert([e]).select()},async updateCategory(e,t){return await a().from("community_categories").update(t).eq("id",e).select()},async deleteCategory(e){return await a().from("community_categories").delete().eq("id",e)}};export{_ as a,f as c};
