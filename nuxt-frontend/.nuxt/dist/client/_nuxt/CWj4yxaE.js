import{E as N,a as F}from"./C7QSzEzh.js";import{E as I}from"./CoJKtQsI.js";import{E as R}from"./B77-r_qQ.js";import{E as G}from"./DAIghOY5.js";import{E as $}from"./BTKFVfca.js";import{r as y,h as H,B as c,f as O,c as v,b as o,w as t,l,o as p,aX as X,d as s,a$ as j,a as u,cz as q,G as w,D as V,t as d,F as J,k as Q,_ as W}from"./CEI0siaN.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import{A as Y}from"./Jf5bIUYa.js";import{A as Z}from"./Zi8pc7L8.js";import{P as ee}from"./BSp69RIM.js";/* empty css        *//* empty css        *//* empty css        */import{a as z}from"./DCP3zBTZ.js";import{u as te}from"./Ce6k4emn.js";import{E as P}from"./BOUQDXLJ.js";import"./BB_Ol6Sd.js";import"./Cp1EI20B.js";import"./Dnj8X3EN.js";import"./97-vZjNt.js";import"./DqBrY_lx.js";import"./Cq9Fpw4b.js";import"./DE5qJ7kT.js";import"./CCDBlmbt.js";import"./CNYNJsmX.js";import"./BjbJQEzT.js";import"./wVnq5BSo.js";import"./Bh6H2ams.js";import"./BC9Y1jC9.js";import"./BzZM8Et6.js";import"./DW0_wk9g.js";import"./CChPPi86.js";import"./B_7HZhJl.js";import"./D-7LAYt0.js";import"./CB_o0Cdi.js";import"./DxNR5PDn.js";import"./uZ_KtR8H.js";import"./C6m5ANi3.js";import"./PbH8IyH8.js";/* empty css        */import"./CgQ-l74f.js";import"./Ct1yoKpA.js";import"./DIhsiPve.js";import"./aSYcAdI9.js";import"./BCllKHMW.js";import"./CXRxotb2.js";import"./OwHC_0Ap.js";/* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        *//* empty css        */import"./BrE0JoK1.js";import"./DB7JGTAC.js";/* empty css        */import"./hs4dPNZ2.js";import"./tbxUD7ww.js";function oe(){const g=y(!1),k=y([]),h=y("unlinked"),n=y([]),r=async()=>{g.value=!0,n.value=[];try{const a=await z.getAllSkus({showUnlinkedOnly:h.value==="unlinked"});a.success?k.value=a.skus||[]:c.error(a.error||"加载失败")}catch(a){c.error(a.message||"系统错误")}finally{g.value=!1}},C=()=>{r()},b=a=>{P.confirm("确认删除此 SKU (包含解除相关联的所有 CDK/商品绑定)？","删除确认",{type:"warning",confirmButtonText:"确定删除",cancelButtonText:"取消"}).then(async()=>{const f=await z.deleteSkus([a.id]);f.success?(c.success("删除成功"),r()):c.error(f.error)})},S=()=>{n.value.length&&P.confirm(`确认批量删除 ${n.value.length} 个 SKU (强制解绑所有关联)？`,"高风险操作",{type:"error",confirmButtonText:"确定删除",cancelButtonText:"取消"}).then(async()=>{const a=await z.deleteSkus(n.value);a.success?(c.success("批量删除成功"),r()):c.error(a.error)})},T=a=>{n.value=a.map(f=>f.id)},x=a=>a?new Date(a).toLocaleString("zh-CN",{fontSize:"12px"}):"-",{getProductTypeLabel:B,getProductTypeTag:E}=te();return H(()=>{r()}),{loading:g,skus:k,filterMode:h,selectedIds:n,loadSkus:r,handleFilterChange:C,handleDelete:b,handleBulkDelete:S,handleSelectionChange:T,formatDate:x,getProductTypeLabel:B,getProductTypeTag:E}}const ae={class:"skus-page"},ie={class:"filter-group"},le={class:"sku-cell"},ne={class:"sku-info"},se={class:"sku-specs"},re={key:0,class:"linked-products"},me={key:1},pe={class:"time-text"},de=O({__name:"skus",setup(g){const{loading:k,skus:h,filterMode:n,selectedIds:r,loadSkus:C,handleFilterChange:b,handleDelete:S,handleBulkDelete:T,handleSelectionChange:x,formatDate:B,getProductTypeLabel:E,getProductTypeTag:a}=oe();return(f,i)=>{const A=F,L=N,D=I,m=R,M=G,_=$;return p(),v("div",ae,[o(ee,{title:"此处显示所有 SKU 物理数据。删除 SKU 将自动解除它与所有商品和CDK的关联，请谨慎操作。",type:"warning"}),o(Y,null,{default:t(()=>[u("div",ie,[o(L,{modelValue:l(n),"onUpdate:modelValue":i[0]||(i[0]=e=>q(n)?n.value=e:null),onChange:l(b)},{default:t(()=>[o(A,{label:"all"},{default:t(()=>[...i[1]||(i[1]=[s("全部",-1)])]),_:1}),o(A,{label:"unlinked"},{default:t(()=>[...i[2]||(i[2]=[s("未连接",-1)])]),_:1})]),_:1},8,["modelValue","onChange"])])]),actions:t(()=>[o(D,{onClick:l(C),icon:l(X)},{default:t(()=>[...i[3]||(i[3]=[s("刷新",-1)])]),_:1},8,["onClick","icon"]),o(D,{type:"danger",icon:l(j),disabled:!l(r).length,onClick:l(T)},{default:t(()=>[...i[4]||(i[4]=[s(" 批量删除 ",-1)])]),_:1},8,["icon","disabled","onClick"])]),_:1}),o(Z,{ref:"adminTableRef",data:l(h),loading:l(k),onSelectionChange:l(x)},{default:t(()=>[o(m,{type:"selection",width:"55"}),o(m,{label:"SKU 规格",width:"280"},{default:t(({row:e})=>[u("div",le,[e.image?(p(),w(M,{key:0,src:e.image,class:"sku-thumb","preview-src-list":[e.image],"preview-teleported":""},null,8,["src","preview-src-list"])):V("",!0),u("div",ne,[u("div",se,[e.tag_name?(p(),w(_,{key:0,size:"small",type:"info",effect:"plain",style:{"margin-right":"4px"}},{default:t(()=>[s(d(e.tag_name),1)]),_:2},1024)):V("",!0),(p(!0),v(J,null,Q(e.spec_combination||{},(K,U)=>(p(),w(_,{key:U,size:"small",effect:"plain",style:{"margin-right":"4px"}},{default:t(()=>[s(d(U)+": "+d(K),1)]),_:2},1024))),128))])])])]),_:1}),o(m,{label:"类型",width:"100",align:"center"},{default:t(({row:e})=>[o(_,{type:l(a)(e.product_type)},{default:t(()=>[s(d(l(E)(e.product_type)),1)]),_:2},1032,["type"])]),_:1}),o(m,{label:"绑定商品","min-width":"200"},{default:t(({row:e})=>[e.is_linked?(p(),v("div",re,[o(_,{type:"success",effect:"plain",size:"small"},{default:t(()=>[s("已绑定 "+d(e.linked_count)+" 个商品",1)]),_:2},1024)])):(p(),v("div",me,[o(_,{type:"danger",effect:"plain",size:"small"},{default:t(()=>[...i[5]||(i[5]=[s("未绑定",-1)])]),_:1})]))]),_:1}),o(m,{label:"库存",width:"100",align:"center"},{default:t(({row:e})=>[u("span",null,d(e.stock_count!==void 0?e.stock_count:"-"),1)]),_:1}),o(m,{label:"创建时间",width:"180",align:"center"},{default:t(({row:e})=>[u("span",pe,d(l(B)(e.created_at)),1)]),_:1}),o(m,{label:"操作",width:"100",align:"center",fixed:"right"},{default:t(({row:e})=>[o(D,{type:"danger",link:"",size:"small",onClick:K=>l(S)(e)},{default:t(()=>[...i[6]||(i[6]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","loading","onSelectionChange"])])}}}),bt=W(de,[["__scopeId","data-v-8c90ec3c"]]);export{bt as default};
