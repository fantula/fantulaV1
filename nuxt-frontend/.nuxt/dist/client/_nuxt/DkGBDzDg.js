import{dM as c}from"./gYbOYKrZ.js";const d={async getCategories(){const e=c(),{data:t,error:r}=await e.from("faq_categories").select("*").order("sort_order",{ascending:!0});return r?{success:!1,categories:[],error:r.message}:{success:!0,categories:t||[]}},async createCategory(e){const t=c(),{error:r}=await t.from("faq_categories").insert({name:e.name,sort_order:e.sort_order,is_active:!0});return r?{success:!1,error:r.message}:{success:!0}},async updateCategory(e,t){const r=c(),{error:s}=await r.from("faq_categories").update(t).eq("id",e);return s?{success:!1,error:s.message}:{success:!0}},async deleteCategory(e){const t=c(),{count:r}=await t.from("faqs").select("*",{count:"exact",head:!0}).eq("category_id",e);if(r&&r>0)return{success:!1,error:`无法删除：该分类下有 ${r} 个问题，请先移除问题`};const{error:s}=await t.from("faq_categories").delete().eq("id",e);return s?{success:!1,error:s.message}:{success:!0}},async getFaqs(e){const t=c(),r=e?.page||1,s=e?.page_size||20,a=(r-1)*s;let o=t.from("faqs").select(`
                *,
                category:faq_categories(id, name),
                product:products(id, product_name)
            `,{count:"exact"});e?.category_id&&(o=o.eq("category_id",e.category_id)),e?.keyword&&(o=o.ilike("question",`%${e.keyword}%`)),o=o.order("sort_order",{ascending:!0}).range(a,a+s-1);const{data:i,error:n,count:u}=await o;return n?{success:!1,faqs:[],total:0,error:n.message}:{success:!0,faqs:i||[],total:u||0}},async getFaqById(e){const t=c(),{data:r,error:s}=await t.from("faqs").select(`
                *,
                product:products(id, product_name)
            `).eq("id",e).single();return s?{success:!1,error:s.message}:{success:!0,faq:r}},async createFaq(e){const t=c(),{error:r}=await t.from("faqs").insert({category_id:e.category_id||null,question:e.question,answer:e.answer,product_id:e.product_id||null,sort_order:e.sort_order||0,is_active:e.is_active!==!1});return r?{success:!1,error:r.message}:{success:!0}},async updateFaq(e,t){const r=c(),{error:s}=await r.from("faqs").update({category_id:t.category_id||null,question:t.question,answer:t.answer,product_id:t.product_id||null,sort_order:t.sort_order,is_active:t.is_active}).eq("id",e);return s?{success:!1,error:s.message}:{success:!0}},async deleteFaq(e){const t=c(),{error:r}=await t.from("faqs").delete().eq("id",e);return r?{success:!1,error:r.message}:{success:!0}}},f={async getArticles(e=1,t=20){const r=c(),s=(e-1)*t,a=s+t-1,{data:o,count:i,error:n}=await r.from("community_articles").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(s,a);return{data:o,total:i,error:n}},async createArticle(e){return await c().from("community_articles").insert([e]).select()},async updateArticle(e,t){return await c().from("community_articles").update(t).eq("id",e).select()},async deleteArticle(e){return await c().from("community_articles").delete().eq("id",e)},async getArticleById(e){const t=c(),{data:r,error:s}=await t.from("community_articles").select("*").eq("id",e).single();return s?{success:!1,data:null,msg:s.message}:{success:!0,data:r,msg:""}},async getCategories(){return await c().from("community_categories").select("*").order("sort_order",{ascending:!0})},async createCategory(e){return await c().from("community_categories").insert([e]).select()},async updateCategory(e,t){return await c().from("community_categories").update(t).eq("id",e).select()},async deleteCategory(e){return await c().from("community_categories").delete().eq("id",e)}};export{d as a,f as b};
